<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>2.7 并发 | Willon</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="">
    
    <link rel="preload" href="/assets/css/0.styles.129981d3.css" as="style"><link rel="preload" href="/assets/js/app.c08e831f.js" as="script"><link rel="preload" href="/assets/js/2.25a55803.js" as="script"><link rel="preload" href="/assets/js/256.dc16a169.js" as="script"><link rel="prefetch" href="/assets/js/10.2281d860.js"><link rel="prefetch" href="/assets/js/100.bb64d7d5.js"><link rel="prefetch" href="/assets/js/101.c0b48dda.js"><link rel="prefetch" href="/assets/js/102.d9d74660.js"><link rel="prefetch" href="/assets/js/103.704a72b3.js"><link rel="prefetch" href="/assets/js/104.4014e32b.js"><link rel="prefetch" href="/assets/js/105.f98044b0.js"><link rel="prefetch" href="/assets/js/106.97b590dc.js"><link rel="prefetch" href="/assets/js/107.f44408f2.js"><link rel="prefetch" href="/assets/js/108.b25ca2b1.js"><link rel="prefetch" href="/assets/js/109.cef489f2.js"><link rel="prefetch" href="/assets/js/11.f65ad866.js"><link rel="prefetch" href="/assets/js/110.a3b49db2.js"><link rel="prefetch" href="/assets/js/111.00c6fdc9.js"><link rel="prefetch" href="/assets/js/112.0dbf96d5.js"><link rel="prefetch" href="/assets/js/113.f3e65151.js"><link rel="prefetch" href="/assets/js/114.c037ca7a.js"><link rel="prefetch" href="/assets/js/115.da9c3ebd.js"><link rel="prefetch" href="/assets/js/116.9acce4f0.js"><link rel="prefetch" href="/assets/js/117.eac6eefe.js"><link rel="prefetch" href="/assets/js/118.98931f48.js"><link rel="prefetch" href="/assets/js/119.ac9b52f2.js"><link rel="prefetch" href="/assets/js/12.e5d84087.js"><link rel="prefetch" href="/assets/js/120.71b66b83.js"><link rel="prefetch" href="/assets/js/121.b886a0f7.js"><link rel="prefetch" href="/assets/js/122.78c9c08c.js"><link rel="prefetch" href="/assets/js/123.7cf001dd.js"><link rel="prefetch" href="/assets/js/124.2c47dc33.js"><link rel="prefetch" href="/assets/js/125.386ad7e1.js"><link rel="prefetch" href="/assets/js/126.7c903136.js"><link rel="prefetch" href="/assets/js/127.0c97a0ff.js"><link rel="prefetch" href="/assets/js/128.6d304388.js"><link rel="prefetch" href="/assets/js/129.fe95c34e.js"><link rel="prefetch" href="/assets/js/13.fb245120.js"><link rel="prefetch" href="/assets/js/130.e70ec8a1.js"><link rel="prefetch" href="/assets/js/131.e86717cd.js"><link rel="prefetch" href="/assets/js/132.982b5299.js"><link rel="prefetch" href="/assets/js/133.19d69d55.js"><link rel="prefetch" href="/assets/js/134.1eb862d5.js"><link rel="prefetch" href="/assets/js/135.2dbf721f.js"><link rel="prefetch" href="/assets/js/136.67408a81.js"><link rel="prefetch" href="/assets/js/137.7984e1cb.js"><link rel="prefetch" href="/assets/js/138.7aa53d81.js"><link rel="prefetch" href="/assets/js/139.20e61879.js"><link rel="prefetch" href="/assets/js/14.772abedc.js"><link rel="prefetch" href="/assets/js/140.e294528f.js"><link rel="prefetch" href="/assets/js/141.c0349506.js"><link rel="prefetch" href="/assets/js/142.f7dc0a51.js"><link rel="prefetch" href="/assets/js/143.2232888a.js"><link rel="prefetch" href="/assets/js/144.075a24c0.js"><link rel="prefetch" href="/assets/js/145.00f057a3.js"><link rel="prefetch" href="/assets/js/146.008904fa.js"><link rel="prefetch" href="/assets/js/147.e5e45ce0.js"><link rel="prefetch" href="/assets/js/148.6581f6a3.js"><link rel="prefetch" href="/assets/js/149.c017990e.js"><link rel="prefetch" href="/assets/js/15.43f9b159.js"><link rel="prefetch" href="/assets/js/150.340693ea.js"><link rel="prefetch" href="/assets/js/151.8a748527.js"><link rel="prefetch" href="/assets/js/152.adb7657c.js"><link rel="prefetch" href="/assets/js/153.acddcc5c.js"><link rel="prefetch" href="/assets/js/154.73f33c7d.js"><link rel="prefetch" href="/assets/js/155.b1c2424f.js"><link rel="prefetch" href="/assets/js/156.40e2e438.js"><link rel="prefetch" href="/assets/js/157.a28ceed6.js"><link rel="prefetch" href="/assets/js/158.2a584466.js"><link rel="prefetch" href="/assets/js/159.021602c7.js"><link rel="prefetch" href="/assets/js/16.35434bd6.js"><link rel="prefetch" href="/assets/js/160.c27aa350.js"><link rel="prefetch" href="/assets/js/161.17026b84.js"><link rel="prefetch" href="/assets/js/162.148ded8c.js"><link rel="prefetch" href="/assets/js/163.93025749.js"><link rel="prefetch" href="/assets/js/164.82562b3d.js"><link rel="prefetch" href="/assets/js/165.e74dd1c1.js"><link rel="prefetch" href="/assets/js/166.30ee2272.js"><link rel="prefetch" href="/assets/js/167.8968b5cc.js"><link rel="prefetch" href="/assets/js/168.917db7ad.js"><link rel="prefetch" href="/assets/js/169.33b4ee12.js"><link rel="prefetch" href="/assets/js/17.7ef4b5aa.js"><link rel="prefetch" href="/assets/js/170.17691d0d.js"><link rel="prefetch" href="/assets/js/171.e851ea32.js"><link rel="prefetch" href="/assets/js/172.ef0ad118.js"><link rel="prefetch" href="/assets/js/173.4793df72.js"><link rel="prefetch" href="/assets/js/174.778cd853.js"><link rel="prefetch" href="/assets/js/175.72b1d4e9.js"><link rel="prefetch" href="/assets/js/176.3608b384.js"><link rel="prefetch" href="/assets/js/177.17556552.js"><link rel="prefetch" href="/assets/js/178.2e25a5a1.js"><link rel="prefetch" href="/assets/js/179.b103c697.js"><link rel="prefetch" href="/assets/js/18.e35979b6.js"><link rel="prefetch" href="/assets/js/180.d624947a.js"><link rel="prefetch" href="/assets/js/181.74d6d8f8.js"><link rel="prefetch" href="/assets/js/182.967f15c7.js"><link rel="prefetch" href="/assets/js/183.3920656b.js"><link rel="prefetch" href="/assets/js/184.52544cc7.js"><link rel="prefetch" href="/assets/js/185.e195abdd.js"><link rel="prefetch" href="/assets/js/186.c13da608.js"><link rel="prefetch" href="/assets/js/187.5b20e53c.js"><link rel="prefetch" href="/assets/js/188.55e42087.js"><link rel="prefetch" href="/assets/js/189.3a03a4c0.js"><link rel="prefetch" href="/assets/js/19.69bf375e.js"><link rel="prefetch" href="/assets/js/190.292e5beb.js"><link rel="prefetch" href="/assets/js/191.15027eae.js"><link rel="prefetch" href="/assets/js/192.74419e54.js"><link rel="prefetch" href="/assets/js/193.9a47936a.js"><link rel="prefetch" href="/assets/js/194.d96e0cfc.js"><link rel="prefetch" href="/assets/js/195.d6dacf5f.js"><link rel="prefetch" href="/assets/js/196.a33d970a.js"><link rel="prefetch" href="/assets/js/197.c5a428f2.js"><link rel="prefetch" href="/assets/js/198.779dbdd6.js"><link rel="prefetch" href="/assets/js/199.91146db9.js"><link rel="prefetch" href="/assets/js/20.d7db684c.js"><link rel="prefetch" href="/assets/js/200.215e60c9.js"><link rel="prefetch" href="/assets/js/201.ed408992.js"><link rel="prefetch" href="/assets/js/202.51b14231.js"><link rel="prefetch" href="/assets/js/203.2eb14ea4.js"><link rel="prefetch" href="/assets/js/204.709b71e0.js"><link rel="prefetch" href="/assets/js/205.454c23f9.js"><link rel="prefetch" href="/assets/js/206.c7e4d734.js"><link rel="prefetch" href="/assets/js/207.e1aa0a78.js"><link rel="prefetch" href="/assets/js/208.03e805e4.js"><link rel="prefetch" href="/assets/js/209.83eacce8.js"><link rel="prefetch" href="/assets/js/21.1338f9b8.js"><link rel="prefetch" href="/assets/js/210.c75a8f58.js"><link rel="prefetch" href="/assets/js/211.51e9b1bb.js"><link rel="prefetch" href="/assets/js/212.14cd114b.js"><link rel="prefetch" href="/assets/js/213.17f9614d.js"><link rel="prefetch" href="/assets/js/214.299a4d2b.js"><link rel="prefetch" href="/assets/js/215.966a4e6e.js"><link rel="prefetch" href="/assets/js/216.2ae7213d.js"><link rel="prefetch" href="/assets/js/217.cb11fe2f.js"><link rel="prefetch" href="/assets/js/218.e6f5e6de.js"><link rel="prefetch" href="/assets/js/219.5905af7b.js"><link rel="prefetch" href="/assets/js/22.816b8291.js"><link rel="prefetch" href="/assets/js/220.3c0eeed2.js"><link rel="prefetch" href="/assets/js/221.a8c7ac25.js"><link rel="prefetch" href="/assets/js/222.6cea1067.js"><link rel="prefetch" href="/assets/js/223.f8066691.js"><link rel="prefetch" href="/assets/js/224.5cbc3b0b.js"><link rel="prefetch" href="/assets/js/225.407c5211.js"><link rel="prefetch" href="/assets/js/226.59cc08e0.js"><link rel="prefetch" href="/assets/js/227.97095143.js"><link rel="prefetch" href="/assets/js/228.555bcf9f.js"><link rel="prefetch" href="/assets/js/229.3365db7f.js"><link rel="prefetch" href="/assets/js/23.0fd49c5f.js"><link rel="prefetch" href="/assets/js/230.5ec864e0.js"><link rel="prefetch" href="/assets/js/231.6d1c49e0.js"><link rel="prefetch" href="/assets/js/232.7bc35e7c.js"><link rel="prefetch" href="/assets/js/233.d9b678e1.js"><link rel="prefetch" href="/assets/js/234.3c93b2af.js"><link rel="prefetch" href="/assets/js/235.6a2e089b.js"><link rel="prefetch" href="/assets/js/236.34fc7d74.js"><link rel="prefetch" href="/assets/js/237.e59be71f.js"><link rel="prefetch" href="/assets/js/238.61782feb.js"><link rel="prefetch" href="/assets/js/239.0fdb1947.js"><link rel="prefetch" href="/assets/js/24.71e4082b.js"><link rel="prefetch" href="/assets/js/240.30ced1ca.js"><link rel="prefetch" href="/assets/js/241.79b8da58.js"><link rel="prefetch" href="/assets/js/242.9bf8328c.js"><link rel="prefetch" href="/assets/js/243.29a72cef.js"><link rel="prefetch" href="/assets/js/244.f953b243.js"><link rel="prefetch" href="/assets/js/245.bce35e93.js"><link rel="prefetch" href="/assets/js/246.219881cf.js"><link rel="prefetch" href="/assets/js/247.17bcfa49.js"><link rel="prefetch" href="/assets/js/248.b188e6a8.js"><link rel="prefetch" href="/assets/js/249.0156a1f0.js"><link rel="prefetch" href="/assets/js/25.564c8a05.js"><link rel="prefetch" href="/assets/js/250.5e830ee1.js"><link rel="prefetch" href="/assets/js/251.dd0a78c1.js"><link rel="prefetch" href="/assets/js/252.3c8c22c8.js"><link rel="prefetch" href="/assets/js/253.3097fcdd.js"><link rel="prefetch" href="/assets/js/254.c85d2415.js"><link rel="prefetch" href="/assets/js/255.6f5cef60.js"><link rel="prefetch" href="/assets/js/257.8d583c2c.js"><link rel="prefetch" href="/assets/js/258.4b54e338.js"><link rel="prefetch" href="/assets/js/259.c4cdbc7e.js"><link rel="prefetch" href="/assets/js/26.98af5525.js"><link rel="prefetch" href="/assets/js/260.e5054157.js"><link rel="prefetch" href="/assets/js/261.32696838.js"><link rel="prefetch" href="/assets/js/262.567540a4.js"><link rel="prefetch" href="/assets/js/263.1a6e6b02.js"><link rel="prefetch" href="/assets/js/264.d87d4d18.js"><link rel="prefetch" href="/assets/js/265.54e1fc54.js"><link rel="prefetch" href="/assets/js/266.96e54e0f.js"><link rel="prefetch" href="/assets/js/267.10e99c58.js"><link rel="prefetch" href="/assets/js/268.aac8e25e.js"><link rel="prefetch" href="/assets/js/269.207333fa.js"><link rel="prefetch" href="/assets/js/27.5db2f5b7.js"><link rel="prefetch" href="/assets/js/270.930ad24d.js"><link rel="prefetch" href="/assets/js/271.05fd90c3.js"><link rel="prefetch" href="/assets/js/272.46bb961c.js"><link rel="prefetch" href="/assets/js/273.98baa340.js"><link rel="prefetch" href="/assets/js/274.485e6e90.js"><link rel="prefetch" href="/assets/js/275.f81090ba.js"><link rel="prefetch" href="/assets/js/276.42f59a62.js"><link rel="prefetch" href="/assets/js/277.d6759ed7.js"><link rel="prefetch" href="/assets/js/278.8150e9cd.js"><link rel="prefetch" href="/assets/js/279.aa53c024.js"><link rel="prefetch" href="/assets/js/28.9857fd74.js"><link rel="prefetch" href="/assets/js/280.c51cbd84.js"><link rel="prefetch" href="/assets/js/281.25367c74.js"><link rel="prefetch" href="/assets/js/282.1ccb9d77.js"><link rel="prefetch" href="/assets/js/283.384767b9.js"><link rel="prefetch" href="/assets/js/284.01fa38e7.js"><link rel="prefetch" href="/assets/js/285.9ddf3f18.js"><link rel="prefetch" href="/assets/js/286.8950dbfd.js"><link rel="prefetch" href="/assets/js/287.8f5ae474.js"><link rel="prefetch" href="/assets/js/288.194d03f6.js"><link rel="prefetch" href="/assets/js/289.9a520da5.js"><link rel="prefetch" href="/assets/js/29.226b66b7.js"><link rel="prefetch" href="/assets/js/290.cb874a45.js"><link rel="prefetch" href="/assets/js/291.9c898578.js"><link rel="prefetch" href="/assets/js/292.d6a441b1.js"><link rel="prefetch" href="/assets/js/293.b843403a.js"><link rel="prefetch" href="/assets/js/294.3ec379a3.js"><link rel="prefetch" href="/assets/js/295.4807c565.js"><link rel="prefetch" href="/assets/js/296.ed0e039a.js"><link rel="prefetch" href="/assets/js/297.47711151.js"><link rel="prefetch" href="/assets/js/298.8d0154bf.js"><link rel="prefetch" href="/assets/js/299.bcbcb6cd.js"><link rel="prefetch" href="/assets/js/3.4ba92e62.js"><link rel="prefetch" href="/assets/js/30.f67ba32f.js"><link rel="prefetch" href="/assets/js/300.812f9dfa.js"><link rel="prefetch" href="/assets/js/301.4ebaa1a5.js"><link rel="prefetch" href="/assets/js/302.76085ff8.js"><link rel="prefetch" href="/assets/js/303.1dd613cd.js"><link rel="prefetch" href="/assets/js/304.29e980a9.js"><link rel="prefetch" href="/assets/js/305.06888abd.js"><link rel="prefetch" href="/assets/js/306.8611c006.js"><link rel="prefetch" href="/assets/js/307.4784aae0.js"><link rel="prefetch" href="/assets/js/308.b20659eb.js"><link rel="prefetch" href="/assets/js/309.9026f7d8.js"><link rel="prefetch" href="/assets/js/31.a0943f9b.js"><link rel="prefetch" href="/assets/js/310.560e1b35.js"><link rel="prefetch" href="/assets/js/311.debebdd1.js"><link rel="prefetch" href="/assets/js/312.2feca467.js"><link rel="prefetch" href="/assets/js/313.e4fd119b.js"><link rel="prefetch" href="/assets/js/314.cfc9040f.js"><link rel="prefetch" href="/assets/js/315.4e65a5b9.js"><link rel="prefetch" href="/assets/js/316.d3d1b161.js"><link rel="prefetch" href="/assets/js/317.a5b0fe9e.js"><link rel="prefetch" href="/assets/js/318.6a06a07c.js"><link rel="prefetch" href="/assets/js/319.7fd89359.js"><link rel="prefetch" href="/assets/js/32.0fb7e6eb.js"><link rel="prefetch" href="/assets/js/320.f5440476.js"><link rel="prefetch" href="/assets/js/321.ee4941c8.js"><link rel="prefetch" href="/assets/js/322.b2c240fe.js"><link rel="prefetch" href="/assets/js/323.755a8ca7.js"><link rel="prefetch" href="/assets/js/324.dc3560c3.js"><link rel="prefetch" href="/assets/js/325.eabe5f92.js"><link rel="prefetch" href="/assets/js/326.d87b64d3.js"><link rel="prefetch" href="/assets/js/327.475b994f.js"><link rel="prefetch" href="/assets/js/328.407fd7f9.js"><link rel="prefetch" href="/assets/js/329.14ffa888.js"><link rel="prefetch" href="/assets/js/33.66eb82a5.js"><link rel="prefetch" href="/assets/js/330.4917942e.js"><link rel="prefetch" href="/assets/js/331.f371a032.js"><link rel="prefetch" href="/assets/js/332.eb101ea4.js"><link rel="prefetch" href="/assets/js/333.2a038d52.js"><link rel="prefetch" href="/assets/js/334.b9bc5737.js"><link rel="prefetch" href="/assets/js/335.3219b32a.js"><link rel="prefetch" href="/assets/js/336.007ad528.js"><link rel="prefetch" href="/assets/js/337.2c7f47cf.js"><link rel="prefetch" href="/assets/js/338.9fd74a96.js"><link rel="prefetch" href="/assets/js/339.668da999.js"><link rel="prefetch" href="/assets/js/34.682b234c.js"><link rel="prefetch" href="/assets/js/340.8875cc4c.js"><link rel="prefetch" href="/assets/js/341.a6dddff4.js"><link rel="prefetch" href="/assets/js/342.c6af0cf7.js"><link rel="prefetch" href="/assets/js/343.b49cf311.js"><link rel="prefetch" href="/assets/js/344.c89de8cb.js"><link rel="prefetch" href="/assets/js/345.79c075e7.js"><link rel="prefetch" href="/assets/js/346.c5e8d1e9.js"><link rel="prefetch" href="/assets/js/347.93036bf8.js"><link rel="prefetch" href="/assets/js/348.5c35ba2d.js"><link rel="prefetch" href="/assets/js/349.3efce8fe.js"><link rel="prefetch" href="/assets/js/35.91b053df.js"><link rel="prefetch" href="/assets/js/350.35abe263.js"><link rel="prefetch" href="/assets/js/351.1c79fb3e.js"><link rel="prefetch" href="/assets/js/352.1d813998.js"><link rel="prefetch" href="/assets/js/353.48bdb993.js"><link rel="prefetch" href="/assets/js/354.8e66b3f0.js"><link rel="prefetch" href="/assets/js/355.49df2e19.js"><link rel="prefetch" href="/assets/js/356.341f52b8.js"><link rel="prefetch" href="/assets/js/357.647c4994.js"><link rel="prefetch" href="/assets/js/358.2c418d7d.js"><link rel="prefetch" href="/assets/js/359.4aa4edbc.js"><link rel="prefetch" href="/assets/js/36.7c6060a0.js"><link rel="prefetch" href="/assets/js/360.6a23c8c1.js"><link rel="prefetch" href="/assets/js/361.08244cda.js"><link rel="prefetch" href="/assets/js/362.ff9c25fb.js"><link rel="prefetch" href="/assets/js/363.d33e77c1.js"><link rel="prefetch" href="/assets/js/364.b3c002dd.js"><link rel="prefetch" href="/assets/js/365.8880d182.js"><link rel="prefetch" href="/assets/js/37.9d530c7a.js"><link rel="prefetch" href="/assets/js/38.6c35a6b2.js"><link rel="prefetch" href="/assets/js/39.c7238bcb.js"><link rel="prefetch" href="/assets/js/4.4fbf9a5d.js"><link rel="prefetch" href="/assets/js/40.a3d4defe.js"><link rel="prefetch" href="/assets/js/41.3fcd03d6.js"><link rel="prefetch" href="/assets/js/42.6808ea71.js"><link rel="prefetch" href="/assets/js/43.01f397a4.js"><link rel="prefetch" href="/assets/js/44.c776bec2.js"><link rel="prefetch" href="/assets/js/45.be158d0a.js"><link rel="prefetch" href="/assets/js/46.6b20556f.js"><link rel="prefetch" href="/assets/js/47.7505afe6.js"><link rel="prefetch" href="/assets/js/48.95a0c30f.js"><link rel="prefetch" href="/assets/js/49.266dbacb.js"><link rel="prefetch" href="/assets/js/5.7d228105.js"><link rel="prefetch" href="/assets/js/50.99e7e4ee.js"><link rel="prefetch" href="/assets/js/51.8cbab272.js"><link rel="prefetch" href="/assets/js/52.1541863f.js"><link rel="prefetch" href="/assets/js/53.3882ee02.js"><link rel="prefetch" href="/assets/js/54.bee64581.js"><link rel="prefetch" href="/assets/js/55.33207c82.js"><link rel="prefetch" href="/assets/js/56.a202eaab.js"><link rel="prefetch" href="/assets/js/57.0967fe19.js"><link rel="prefetch" href="/assets/js/58.cde1e7ea.js"><link rel="prefetch" href="/assets/js/59.73c644f2.js"><link rel="prefetch" href="/assets/js/6.47bcfd5b.js"><link rel="prefetch" href="/assets/js/60.b6eeb43b.js"><link rel="prefetch" href="/assets/js/61.3a219fc3.js"><link rel="prefetch" href="/assets/js/62.91a61505.js"><link rel="prefetch" href="/assets/js/63.27195dd5.js"><link rel="prefetch" href="/assets/js/64.9373816d.js"><link rel="prefetch" href="/assets/js/65.41177549.js"><link rel="prefetch" href="/assets/js/66.215ce354.js"><link rel="prefetch" href="/assets/js/67.717f375e.js"><link rel="prefetch" href="/assets/js/68.b7c427cd.js"><link rel="prefetch" href="/assets/js/69.77d4517f.js"><link rel="prefetch" href="/assets/js/7.d77aeb7d.js"><link rel="prefetch" href="/assets/js/70.a54a665a.js"><link rel="prefetch" href="/assets/js/71.0d8dbdff.js"><link rel="prefetch" href="/assets/js/72.fd1c8226.js"><link rel="prefetch" href="/assets/js/73.5d0fcdf6.js"><link rel="prefetch" href="/assets/js/74.2e488f8d.js"><link rel="prefetch" href="/assets/js/75.5bfdee07.js"><link rel="prefetch" href="/assets/js/76.f5121347.js"><link rel="prefetch" href="/assets/js/77.fa7c777d.js"><link rel="prefetch" href="/assets/js/78.ce6c5ed8.js"><link rel="prefetch" href="/assets/js/79.43bd74d5.js"><link rel="prefetch" href="/assets/js/8.44ee9d62.js"><link rel="prefetch" href="/assets/js/80.97b3f8bf.js"><link rel="prefetch" href="/assets/js/81.49d1728d.js"><link rel="prefetch" href="/assets/js/82.5f1cb6c8.js"><link rel="prefetch" href="/assets/js/83.46e8f777.js"><link rel="prefetch" href="/assets/js/84.fc47072b.js"><link rel="prefetch" href="/assets/js/85.366f09a1.js"><link rel="prefetch" href="/assets/js/86.914a3ddd.js"><link rel="prefetch" href="/assets/js/87.baa05245.js"><link rel="prefetch" href="/assets/js/88.9faab6a4.js"><link rel="prefetch" href="/assets/js/89.ae3646d9.js"><link rel="prefetch" href="/assets/js/9.8c8d8b8f.js"><link rel="prefetch" href="/assets/js/90.182d7e7a.js"><link rel="prefetch" href="/assets/js/91.d08bdf93.js"><link rel="prefetch" href="/assets/js/92.481618be.js"><link rel="prefetch" href="/assets/js/93.08df5b9c.js"><link rel="prefetch" href="/assets/js/94.4443762a.js"><link rel="prefetch" href="/assets/js/95.52a4f20f.js"><link rel="prefetch" href="/assets/js/96.02aa8fce.js"><link rel="prefetch" href="/assets/js/97.3e5aa030.js"><link rel="prefetch" href="/assets/js/98.dc27113d.js"><link rel="prefetch" href="/assets/js/99.a49f88b3.js">
    <link rel="stylesheet" href="/assets/css/0.styles.129981d3.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Willon</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="微服务" class="dropdown-title"><span class="title">微服务</span> <span class="arrow down"></span></button> <button type="button" aria-label="微服务" class="mobile-dropdown-title"><span class="title">微服务</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/微服务/SpringCloudAlibaba/" class="nav-link">
  SpringCloudAlibaba
</a></li><li class="dropdown-item"><!----> <a href="/微服务/SpringCloud/" class="nav-link">
  SpringCloud
</a></li><li class="dropdown-item"><!----> <a href="/微服务/Docker/" class="nav-link">
  Docker
</a></li><li class="dropdown-item"><!----> <a href="/微服务/Dubbo/" class="nav-link">
  Dubbo
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="大数据" class="dropdown-title"><span class="title">大数据</span> <span class="arrow down"></span></button> <button type="button" aria-label="大数据" class="mobile-dropdown-title"><span class="title">大数据</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/大数据/Hadoop/" class="nav-link">
  Hadoop
</a></li><li class="dropdown-item"><!----> <a href="/大数据/Spark/" class="nav-link">
  Spark
</a></li></ul></div></div><div class="nav-item"><a href="/成神之路/" class="nav-link">
  成神之路
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="编程语言" class="dropdown-title"><span class="title">编程语言</span> <span class="arrow down"></span></button> <button type="button" aria-label="编程语言" class="mobile-dropdown-title"><span class="title">编程语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/编程语言/Scala/" class="nav-link">
  Scala
</a></li><li class="dropdown-item"><!----> <a href="/编程语言/Python/" class="nav-link">
  Python
</a></li><li class="dropdown-item"><!----> <a href="/编程语言/Go/" class="nav-link">
  Go
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他手艺" class="dropdown-title"><span class="title">其他手艺</span> <span class="arrow down"></span></button> <button type="button" aria-label="其他手艺" class="mobile-dropdown-title"><span class="title">其他手艺</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/其他手艺/Share/" class="nav-link">
  Share
</a></li><li class="dropdown-item"><!----> <a href="/其他手艺/Android/" class="nav-link">
  Android
</a></li><li class="dropdown-item"><!----> <a href="/其他手艺/GIT/" class="nav-link">
  GIT
</a></li><li class="dropdown-item"><!----> <a href="/其他手艺/Photography/" class="nav-link">
  Photography
</a></li><li class="dropdown-item"><!----> <a href="/其他手艺/大前端/" class="nav-link">
  大前端
</a></li></ul></div></div><div class="nav-item"><a href="/Linux/" class="nav-link">
  Linux
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java核心" class="dropdown-title"><span class="title">Java核心</span> <span class="arrow down"></span></button> <button type="button" aria-label="Java核心" class="mobile-dropdown-title"><span class="title">Java核心</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          数据库
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Java核心/数据库/MySQL/" class="nav-link">
  MySQL
</a></li><li class="dropdown-subitem"><a href="/Java核心/数据库/Oracle/" class="nav-link">
  Oracle
</a></li><li class="dropdown-subitem"><a href="/Java核心/数据库/Redis/" class="nav-link">
  Redis
</a></li></ul></li><li class="dropdown-item"><!----> <a href="/Java核心/基础知识/" class="nav-link">
  基础知识
</a></li><li class="dropdown-item"><!----> <a href="/Java核心/安全框架/" class="nav-link">
  安全框架
</a></li><li class="dropdown-item"><!----> <a href="/Java核心/设计模式/" class="nav-link">
  设计模式
</a></li><li class="dropdown-item"><!----> <a href="/Java核心/SpringBoot/" class="nav-link">
  SpringBoot
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="微服务" class="dropdown-title"><span class="title">微服务</span> <span class="arrow down"></span></button> <button type="button" aria-label="微服务" class="mobile-dropdown-title"><span class="title">微服务</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/微服务/SpringCloudAlibaba/" class="nav-link">
  SpringCloudAlibaba
</a></li><li class="dropdown-item"><!----> <a href="/微服务/SpringCloud/" class="nav-link">
  SpringCloud
</a></li><li class="dropdown-item"><!----> <a href="/微服务/Docker/" class="nav-link">
  Docker
</a></li><li class="dropdown-item"><!----> <a href="/微服务/Dubbo/" class="nav-link">
  Dubbo
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="大数据" class="dropdown-title"><span class="title">大数据</span> <span class="arrow down"></span></button> <button type="button" aria-label="大数据" class="mobile-dropdown-title"><span class="title">大数据</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/大数据/Hadoop/" class="nav-link">
  Hadoop
</a></li><li class="dropdown-item"><!----> <a href="/大数据/Spark/" class="nav-link">
  Spark
</a></li></ul></div></div><div class="nav-item"><a href="/成神之路/" class="nav-link">
  成神之路
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="编程语言" class="dropdown-title"><span class="title">编程语言</span> <span class="arrow down"></span></button> <button type="button" aria-label="编程语言" class="mobile-dropdown-title"><span class="title">编程语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/编程语言/Scala/" class="nav-link">
  Scala
</a></li><li class="dropdown-item"><!----> <a href="/编程语言/Python/" class="nav-link">
  Python
</a></li><li class="dropdown-item"><!----> <a href="/编程语言/Go/" class="nav-link">
  Go
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他手艺" class="dropdown-title"><span class="title">其他手艺</span> <span class="arrow down"></span></button> <button type="button" aria-label="其他手艺" class="mobile-dropdown-title"><span class="title">其他手艺</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/其他手艺/Share/" class="nav-link">
  Share
</a></li><li class="dropdown-item"><!----> <a href="/其他手艺/Android/" class="nav-link">
  Android
</a></li><li class="dropdown-item"><!----> <a href="/其他手艺/GIT/" class="nav-link">
  GIT
</a></li><li class="dropdown-item"><!----> <a href="/其他手艺/Photography/" class="nav-link">
  Photography
</a></li><li class="dropdown-item"><!----> <a href="/其他手艺/大前端/" class="nav-link">
  大前端
</a></li></ul></div></div><div class="nav-item"><a href="/Linux/" class="nav-link">
  Linux
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java核心" class="dropdown-title"><span class="title">Java核心</span> <span class="arrow down"></span></button> <button type="button" aria-label="Java核心" class="mobile-dropdown-title"><span class="title">Java核心</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          数据库
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Java核心/数据库/MySQL/" class="nav-link">
  MySQL
</a></li><li class="dropdown-subitem"><a href="/Java核心/数据库/Oracle/" class="nav-link">
  Oracle
</a></li><li class="dropdown-subitem"><a href="/Java核心/数据库/Redis/" class="nav-link">
  Redis
</a></li></ul></li><li class="dropdown-item"><!----> <a href="/Java核心/基础知识/" class="nav-link">
  基础知识
</a></li><li class="dropdown-item"><!----> <a href="/Java核心/安全框架/" class="nav-link">
  安全框架
</a></li><li class="dropdown-item"><!----> <a href="/Java核心/设计模式/" class="nav-link">
  设计模式
</a></li><li class="dropdown-item"><!----> <a href="/Java核心/SpringBoot/" class="nav-link">
  SpringBoot
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/" aria-current="page" class="sidebar-link">GoWeb编程</a></li><li><a href="/编程语言/Go/01.0.html" class="sidebar-link">1 GO环境配置</a></li><li><a href="/编程语言/Go/01.1.html" class="sidebar-link">1.1安装 Go</a></li><li><a href="/编程语言/Go/01.2.html" class="sidebar-link">1.2 GOPATH与工作空间</a></li><li><a href="/编程语言/Go/01.3.html" class="sidebar-link">1.3 Go 命令</a></li><li><a href="/编程语言/Go/01.4.html" class="sidebar-link">1.4 Go开发工具</a></li><li><a href="/编程语言/Go/01.5.html" class="sidebar-link">1.5 总结</a></li><li><a href="/编程语言/Go/02.0.html" class="sidebar-link">2 Go语言基础</a></li><li><a href="/编程语言/Go/02.1.html" class="sidebar-link">2.1 你好，Go</a></li><li><a href="/编程语言/Go/02.2.html" class="sidebar-link">2.2 Go基础</a></li><li><a href="/编程语言/Go/02.3.html" class="sidebar-link">2.3 流程和函数</a></li><li><a href="/编程语言/Go/02.4.html" class="sidebar-link">2.4 struct类型</a></li><li><a href="/编程语言/Go/02.5.html" class="sidebar-link">2.5 面向对象</a></li><li><a href="/编程语言/Go/02.6.html" class="sidebar-link">2.6 interface</a></li><li><a href="/编程语言/Go/02.7.html" class="active sidebar-link">2.7 并发</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/编程语言/Go/02.7.html#goroutine" class="sidebar-link">goroutine</a></li><li class="sidebar-sub-header"><a href="/编程语言/Go/02.7.html#channels" class="sidebar-link">channels</a></li><li class="sidebar-sub-header"><a href="/编程语言/Go/02.7.html#buffered-channels" class="sidebar-link">Buffered Channels</a></li><li class="sidebar-sub-header"><a href="/编程语言/Go/02.7.html#range和close" class="sidebar-link">Range和Close</a></li><li class="sidebar-sub-header"><a href="/编程语言/Go/02.7.html#select" class="sidebar-link">Select</a></li><li class="sidebar-sub-header"><a href="/编程语言/Go/02.7.html#超时" class="sidebar-link">超时</a></li><li class="sidebar-sub-header"><a href="/编程语言/Go/02.7.html#runtime-goroutine" class="sidebar-link">runtime goroutine</a></li><li class="sidebar-sub-header"><a href="/编程语言/Go/02.7.html#links" class="sidebar-link">links</a></li></ul></li><li><a href="/编程语言/Go/02.8.html" class="sidebar-link">2.8 总结</a></li><li><a href="/编程语言/Go/03.0.html" class="sidebar-link">3 Web基础</a></li><li><a href="/编程语言/Go/03.1.html" class="sidebar-link">3.1 Web工作方式</a></li><li><a href="/编程语言/Go/03.2.html" class="sidebar-link">3.2 Go搭建一个Web服务器</a></li><li><a href="/编程语言/Go/03.3.html" class="sidebar-link">3.3 Go如何使得Web工作</a></li><li><a href="/编程语言/Go/03.4.html" class="sidebar-link">3.4 Go的http包详解</a></li><li><a href="/编程语言/Go/03.5.html" class="sidebar-link">3.5 小结</a></li><li><a href="/编程语言/Go/04.0.html" class="sidebar-link">4 表单</a></li><li><a href="/编程语言/Go/04.1.html" class="sidebar-link">4.1 处理表单的输入</a></li><li><a href="/编程语言/Go/04.2.html" class="sidebar-link">4.2 验证表单的输入</a></li><li><a href="/编程语言/Go/04.3.html" class="sidebar-link">4.3 预防跨站脚本</a></li><li><a href="/编程语言/Go/04.4.html" class="sidebar-link">4.4 防止多次递交表单</a></li><li><a href="/编程语言/Go/04.5.html" class="sidebar-link">4.5 处理文件上传</a></li><li><a href="/编程语言/Go/04.6.html" class="sidebar-link">4.6 小结</a></li><li><a href="/编程语言/Go/05.0.html" class="sidebar-link">5 访问数据库</a></li><li><a href="/编程语言/Go/05.1.html" class="sidebar-link">5.1 database/sql接口</a></li><li><a href="/编程语言/Go/05.2.html" class="sidebar-link">5.2 使用MySQL数据库</a></li><li><a href="/编程语言/Go/05.3.html" class="sidebar-link">5.3 使用SQLite数据库</a></li><li><a href="/编程语言/Go/05.4.html" class="sidebar-link">5.4 使用PostgreSQL数据库</a></li><li><a href="/编程语言/Go/05.5.html" class="sidebar-link">5.5 使用Beego orm库进行ORM开发</a></li><li><a href="/编程语言/Go/05.6.html" class="sidebar-link">5.6 NOSQL数据库操作</a></li><li><a href="/编程语言/Go/05.7.html" class="sidebar-link">5.7 小结</a></li><li><a href="/编程语言/Go/06.0.html" class="sidebar-link">6 session和数据存储</a></li><li><a href="/编程语言/Go/06.1.html" class="sidebar-link">6.1 session和cookie</a></li><li><a href="/编程语言/Go/06.2.html" class="sidebar-link">6.2 Go如何使用session</a></li><li><a href="/编程语言/Go/06.3.html" class="sidebar-link">6.3 session存储</a></li><li><a href="/编程语言/Go/06.4.html" class="sidebar-link">6.4 预防session劫持</a></li><li><a href="/编程语言/Go/06.5.html" class="sidebar-link">6.5 小结</a></li><li><a href="/编程语言/Go/07.0.html" class="sidebar-link">7 文本处理</a></li><li><a href="/编程语言/Go/07.1.html" class="sidebar-link">7.1 XML处理</a></li><li><a href="/编程语言/Go/07.2.html" class="sidebar-link">7.2 JSON处理</a></li><li><a href="/编程语言/Go/07.3.html" class="sidebar-link">7.3 正则处理</a></li><li><a href="/编程语言/Go/07.5.html" class="sidebar-link">7.5 文件操作</a></li><li><a href="/编程语言/Go/07.6.html" class="sidebar-link">7.6 字符串处理</a></li><li><a href="/编程语言/Go/07.7.html" class="sidebar-link">7.7 小结</a></li><li><a href="/编程语言/Go/08.0.html" class="sidebar-link">8 Web服务</a></li><li><a href="/编程语言/Go/08.1.html" class="sidebar-link">8.1 Socket编程</a></li><li><a href="/编程语言/Go/08.2.html" class="sidebar-link">8.2 WebSocket</a></li><li><a href="/编程语言/Go/08.3.html" class="sidebar-link">8.3 REST</a></li><li><a href="/编程语言/Go/08.4.html" class="sidebar-link">8.4 RPC</a></li><li><a href="/编程语言/Go/08.5.html" class="sidebar-link">8.5 小结</a></li><li><a href="/编程语言/Go/09.0.html" class="sidebar-link">9 安全与加密</a></li><li><a href="/编程语言/Go/09.1.html" class="sidebar-link">9.1 预防CSRF攻击</a></li><li><a href="/编程语言/Go/09.2.html" class="sidebar-link">9.2 确保输入过滤</a></li><li><a href="/编程语言/Go/09.3.html" class="sidebar-link">9.3 避免XSS攻击</a></li><li><a href="/编程语言/Go/09.4.html" class="sidebar-link">9.4 避免SQL注入</a></li><li><a href="/编程语言/Go/09.5.html" class="sidebar-link">9.5 存储密码</a></li><li><a href="/编程语言/Go/09.6.html" class="sidebar-link">9.6 加密和解密数据</a></li><li><a href="/编程语言/Go/09.7.html" class="sidebar-link">9.7 小结</a></li><li><a href="/编程语言/Go/10.0.html" class="sidebar-link">10 国际化和本地化</a></li><li><a href="/编程语言/Go/10.1.html" class="sidebar-link">10.1 设置默认地区</a></li><li><a href="/编程语言/Go/10.2.html" class="sidebar-link">10.2 本地化资源</a></li><li><a href="/编程语言/Go/10.3.html" class="sidebar-link">10.3 国际化站点</a></li><li><a href="/编程语言/Go/10.4.html" class="sidebar-link">10.4 小结</a></li><li><a href="/编程语言/Go/11.0.html" class="sidebar-link">11 错误处理，调试和测试</a></li><li><a href="/编程语言/Go/11.1.html" class="sidebar-link">11.1 错误处理</a></li><li><a href="/编程语言/Go/11.2.html" class="sidebar-link">11.2 使用GDB调试</a></li><li><a href="/编程语言/Go/11.3.html" class="sidebar-link">11.3 Go怎么写测试用例</a></li><li><a href="/编程语言/Go/11.4.html" class="sidebar-link">11.4 小结</a></li><li><a href="/编程语言/Go/12.0.html" class="sidebar-link">12 部署与维护</a></li><li><a href="/编程语言/Go/12.1.html" class="sidebar-link">12.1 应用日志</a></li><li><a href="/编程语言/Go/12.2.html" class="sidebar-link">12.2 网站错误处理</a></li><li><a href="/编程语言/Go/12.3.html" class="sidebar-link">12.3 应用部署</a></li><li><a href="/编程语言/Go/12.4.html" class="sidebar-link">12.4 备份和恢复</a></li><li><a href="/编程语言/Go/12.5.html" class="sidebar-link">12.5 小结</a></li><li><a href="/编程语言/Go/13.0.html" class="sidebar-link">13 如何设计一个Web框架</a></li><li><a href="/编程语言/Go/13.1.html" class="sidebar-link">13.1 项目规划</a></li><li><a href="/编程语言/Go/13.2.html" class="sidebar-link">13.2 自定义路由器设计</a></li><li><a href="/编程语言/Go/13.3.html" class="sidebar-link">13.3 controller设计</a></li><li><a href="/编程语言/Go/13.4.html" class="sidebar-link">13.4 日志和配置设计</a></li><li><a href="/编程语言/Go/13.5.html" class="sidebar-link">13.5 实现博客的增删改</a></li><li><a href="/编程语言/Go/13.6.html" class="sidebar-link">13.6 小结</a></li><li><a href="/编程语言/Go/14.0.html" class="sidebar-link">14 扩展Web框架</a></li><li><a href="/编程语言/Go/14.1.html" class="sidebar-link">14.1 静态文件支持</a></li><li><a href="/编程语言/Go/14.2.html" class="sidebar-link">14.2 Session支持</a></li><li><a href="/编程语言/Go/14.3.html" class="sidebar-link">14.3 表单及验证支持</a></li><li><a href="/编程语言/Go/14.4.html" class="sidebar-link">14.4 用户认证</a></li><li><a href="/编程语言/Go/14.5.html" class="sidebar-link">14.5 多语言支持</a></li><li><a href="/编程语言/Go/14.6.html" class="sidebar-link">14.6 pprof支持</a></li><li><a href="/编程语言/Go/14.7.html" class="sidebar-link">14.7 小结</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="_2-7-并发"><a href="#_2-7-并发" class="header-anchor">#</a> 2.7 并发</h1> <p>有人把Go比作21世纪的C语言，第一是因为Go语言设计简单，第二，21世纪最重要的就是并行程序设计，而Go从语言层面就支持了并行。</p> <h2 id="goroutine"><a href="#goroutine" class="header-anchor">#</a> goroutine</h2> <p>goroutine是Go并行设计的核心。goroutine说到底其实就是协程，但是它比线程更小，十几个goroutine可能体现在底层就是五六个线程，Go语言内部帮你实现了这些goroutine之间的内存共享。执行goroutine只需极少的栈内存(大概是4~5KB)，当然会根据相应的数据伸缩。也正因为如此，可同时运行成千上万个并发任务。goroutine比thread更易用、更高效、更轻便。</p> <p>goroutine是通过Go的runtime管理的一个线程管理器。goroutine通过<code>go</code>关键字实现了，其实就是一个普通的函数。</p> <div class="language-Go extra-class"><pre class="language-go"><code>
<span class="token keyword">go</span> <span class="token function">hello</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">)</span>
</code></pre></div><p>通过关键字go就启动了一个goroutine。我们来看一个例子</p> <div class="language-Go extra-class"><pre class="language-go"><code>
<span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;fmt&quot;</span>
	<span class="token string">&quot;runtime&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">say</span><span class="token punctuation">(</span>s <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span>
		runtime<span class="token punctuation">.</span><span class="token function">Gosched</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">go</span> <span class="token function">say</span><span class="token punctuation">(</span><span class="token string">&quot;world&quot;</span><span class="token punctuation">)</span> <span class="token comment">//开一个新的Goroutines执行</span>
	<span class="token function">say</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span> <span class="token comment">//当前Goroutines执行</span>
<span class="token punctuation">}</span>

<span class="token comment">// 以上程序执行后将输出：</span>
<span class="token comment">// hello</span>
<span class="token comment">// world</span>
<span class="token comment">// hello</span>
<span class="token comment">// world</span>
<span class="token comment">// hello</span>
<span class="token comment">// world</span>
<span class="token comment">// hello</span>
<span class="token comment">// world</span>
<span class="token comment">// hello</span>
</code></pre></div><p>我们可以看到go关键字很方便的就实现了并发编程。
上面的多个goroutine运行在同一个进程里面，共享内存数据，不过设计上我们要遵循：不要通过共享来通信，而要通过通信来共享。</p> <blockquote><p>runtime.Gosched()表示让CPU把时间片让给别人,下次某个时候继续恢复执行该goroutine。</p></blockquote> <blockquote><p>默认情况下，在Go 1.5将标识并发系统线程个数的runtime.GOMAXPROCS的初始值由1改为了运行环境的CPU核数。</p></blockquote> <p>但在Go 1.5以前调度器仅使用单线程，也就是说只实现了并发。想要发挥多核处理器的并行，需要在我们的程序中显式调用 runtime.GOMAXPROCS(n) 告诉调度器同时使用多个线程。GOMAXPROCS 设置了同时运行逻辑代码的系统线程的最大数量，并返回之前的设置。如果n &lt; 1，不会改变当前设置。</p> <h2 id="channels"><a href="#channels" class="header-anchor">#</a> channels</h2> <p>goroutine运行在相同的地址空间，因此访问共享内存必须做好同步。那么goroutine之间如何进行数据的通信呢，Go提供了一个很好的通信机制channel。channel可以与Unix shell 中的双向管道做类比：可以通过它发送或者接收值。这些值只能是特定的类型：channel类型。定义一个channel时，也需要定义发送到channel的值的类型。注意，必须使用make 创建channel：</p> <div class="language-Go extra-class"><pre class="language-go"><code>
ci <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">int</span><span class="token punctuation">)</span>
cs <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">string</span><span class="token punctuation">)</span>
cf <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>channel通过操作符<code>&lt;-</code>来接收和发送数据</p> <div class="language-Go extra-class"><pre class="language-go"><code>
ch <span class="token operator">&lt;-</span> v    <span class="token comment">// 发送v到channel ch.</span>
v <span class="token operator">:=</span> <span class="token operator">&lt;-</span>ch  <span class="token comment">// 从ch中接收数据，并赋值给v</span>
</code></pre></div><p>我们把这些应用到我们的例子中来：</p> <div class="language-Go extra-class"><pre class="language-go"><code>
<span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">func</span> <span class="token function">sum</span><span class="token punctuation">(</span>a <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">,</span> c <span class="token keyword">chan</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	total <span class="token operator">:=</span> <span class="token number">0</span>
	<span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> v <span class="token operator">:=</span> <span class="token keyword">range</span> a <span class="token punctuation">{</span>
		total <span class="token operator">+=</span> v
	<span class="token punctuation">}</span>
	c <span class="token operator">&lt;-</span> total  <span class="token comment">// send total to c</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	a <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">}</span>

	c <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">int</span><span class="token punctuation">)</span>
	<span class="token keyword">go</span> <span class="token function">sum</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token function">len</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c<span class="token punctuation">)</span>
	<span class="token keyword">go</span> <span class="token function">sum</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token function">len</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c<span class="token punctuation">)</span>
	x<span class="token punctuation">,</span> y <span class="token operator">:=</span> <span class="token operator">&lt;-</span>c<span class="token punctuation">,</span> <span class="token operator">&lt;-</span>c  <span class="token comment">// receive from c</span>

	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> x <span class="token operator">+</span> y<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>默认情况下，channel接收和发送数据都是阻塞的，除非另一端已经准备好，这样就使得Goroutines同步变的更加的简单，而不需要显式的lock。所谓阻塞，也就是如果读取（value := &lt;-ch）它将会被阻塞，直到有数据接收。其次，任何发送（ch&lt;-5）将会被阻塞，直到数据被读出。无缓冲channel是在多个goroutine之间同步很棒的工具。</p> <h2 id="buffered-channels"><a href="#buffered-channels" class="header-anchor">#</a> Buffered Channels</h2> <p>上面我们介绍了默认的非缓存类型的channel，不过Go也允许指定channel的缓冲大小，很简单，就是channel可以存储多少元素。ch:= make(chan bool, 4)，创建了可以存储4个元素的bool 型channel。在这个channel 中，前4个元素可以无阻塞的写入。当写入第5个元素时，代码将会阻塞，直到其他goroutine从channel 中读取一些元素，腾出空间。</p> <div class="language-Go extra-class"><pre class="language-go"><code>
ch <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token keyword">type</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span>
</code></pre></div><p>当 value = 0 时，channel 是无缓冲阻塞读写的，当value &gt; 0 时，channel 有缓冲、是非阻塞的，直到写满 value 个元素才阻塞写入。</p> <p>我们看一下下面这个例子，你可以在自己本机测试一下，修改相应的value值</p> <div class="language-Go extra-class"><pre class="language-go"><code>
<span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	c <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token comment">//修改2为1就报错，修改2为3可以正常运行</span>
	c <span class="token operator">&lt;-</span> <span class="token number">1</span>
	c <span class="token operator">&lt;-</span> <span class="token number">2</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token operator">&lt;-</span>c<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token operator">&lt;-</span>c<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
        <span class="token comment">//修改为1报如下的错误:</span>
        <span class="token comment">//fatal error: all goroutines are asleep - deadlock!</span>
</code></pre></div><h2 id="range和close"><a href="#range和close" class="header-anchor">#</a> Range和Close</h2> <p>上面这个例子中，我们需要读取两次c，这样不是很方便，Go考虑到了这一点，所以也可以通过range，像操作slice或者map一样操作缓存类型的channel，请看下面的例子</p> <div class="language-Go extra-class"><pre class="language-go"><code>
<span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;fmt&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">fibonacci</span><span class="token punctuation">(</span>n <span class="token builtin">int</span><span class="token punctuation">,</span> c <span class="token keyword">chan</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	x<span class="token punctuation">,</span> y <span class="token operator">:=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span>
	<span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span>
		c <span class="token operator">&lt;-</span> x
		x<span class="token punctuation">,</span> y <span class="token operator">=</span> y<span class="token punctuation">,</span> x <span class="token operator">+</span> y
	<span class="token punctuation">}</span>
	<span class="token function">close</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	c <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>
	<span class="token keyword">go</span> <span class="token function">fibonacci</span><span class="token punctuation">(</span><span class="token function">cap</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">,</span> c<span class="token punctuation">)</span>
	<span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token keyword">range</span> c <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>for i := range c</code>能够不断的读取channel里面的数据，直到该channel被显式的关闭。上面代码我们看到可以显式的关闭channel，生产者通过内置函数<code>close</code>关闭channel。关闭channel之后就无法再发送任何数据了，在消费方可以通过语法<code>v, ok := &lt;-ch</code>测试channel是否被关闭。如果ok返回false，那么说明channel已经没有任何数据并且已经被关闭。</p> <blockquote><p>记住应该在生产者的地方关闭channel，而不是消费的地方去关闭它，这样容易引起panic</p></blockquote> <blockquote><p>另外记住一点的就是channel不像文件之类的，不需要经常去关闭，只有当你确实没有任何发送数据了，或者你想显式的结束range循环之类的</p></blockquote> <h2 id="select"><a href="#select" class="header-anchor">#</a> Select</h2> <p>我们上面介绍的都是只有一个channel的情况，那么如果存在多个channel的时候，我们该如何操作呢，Go里面提供了一个关键字<code>select</code>，通过<code>select</code>可以监听channel上的数据流动。</p> <p><code>select</code>默认是阻塞的，只有当监听的channel中有发送或接收可以进行时才会运行，当多个channel都准备好的时候，select是随机的选择一个执行的。</p> <div class="language-Go extra-class"><pre class="language-go"><code>
<span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">func</span> <span class="token function">fibonacci</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> quit <span class="token keyword">chan</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	x<span class="token punctuation">,</span> y <span class="token operator">:=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span>
	<span class="token keyword">for</span> <span class="token punctuation">{</span>
		<span class="token keyword">select</span> <span class="token punctuation">{</span>
		<span class="token keyword">case</span> c <span class="token operator">&lt;-</span> x<span class="token punctuation">:</span>
			x<span class="token punctuation">,</span> y <span class="token operator">=</span> y<span class="token punctuation">,</span> x <span class="token operator">+</span> y
		<span class="token keyword">case</span> <span class="token operator">&lt;-</span>quit<span class="token punctuation">:</span>
			fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;quit&quot;</span><span class="token punctuation">)</span>
			<span class="token keyword">return</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	c <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">int</span><span class="token punctuation">)</span>
	quit <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">int</span><span class="token punctuation">)</span>
	<span class="token keyword">go</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span>
			fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token operator">&lt;-</span>c<span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
		quit <span class="token operator">&lt;-</span> <span class="token number">0</span>
	<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token function">fibonacci</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> quit<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>在<code>select</code>里面还有default语法，<code>select</code>其实就是类似switch的功能，default就是当监听的channel都没有准备好的时候，默认执行的（select不再阻塞等待channel）。</p> <div class="language-Go extra-class"><pre class="language-go"><code>
<span class="token keyword">select</span> <span class="token punctuation">{</span>
<span class="token keyword">case</span> i <span class="token operator">:=</span> <span class="token operator">&lt;-</span>c<span class="token punctuation">:</span>
	<span class="token comment">// use i</span>
<span class="token keyword">default</span><span class="token punctuation">:</span>
	<span class="token comment">// 当c阻塞的时候执行这里</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="超时"><a href="#超时" class="header-anchor">#</a> 超时</h2> <p>有时候会出现goroutine阻塞的情况，那么我们如何避免整个程序进入阻塞的情况呢？我们可以利用select来设置超时，通过如下的方式实现：</p> <div class="language-Go extra-class"><pre class="language-go"><code>
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	c <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">int</span><span class="token punctuation">)</span>
	o <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">bool</span><span class="token punctuation">)</span>
	<span class="token keyword">go</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">for</span> <span class="token punctuation">{</span>
			<span class="token keyword">select</span> <span class="token punctuation">{</span>
				<span class="token keyword">case</span> v <span class="token operator">:=</span> <span class="token operator">&lt;-</span> c<span class="token punctuation">:</span>
					<span class="token function">println</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span>
				<span class="token keyword">case</span> <span class="token operator">&lt;-</span> time<span class="token punctuation">.</span><span class="token function">After</span><span class="token punctuation">(</span><span class="token number">5</span> <span class="token operator">*</span> time<span class="token punctuation">.</span>Second<span class="token punctuation">)</span><span class="token punctuation">:</span>
					<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;timeout&quot;</span><span class="token punctuation">)</span>
					o <span class="token operator">&lt;-</span> <span class="token boolean">true</span>
					<span class="token keyword">break</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token operator">&lt;-</span> o
<span class="token punctuation">}</span>
</code></pre></div><h2 id="runtime-goroutine"><a href="#runtime-goroutine" class="header-anchor">#</a> runtime goroutine</h2> <p>runtime包中有几个处理goroutine的函数：</p> <ul><li><p>Goexit</p> <p>退出当前执行的goroutine，但是defer函数还会继续调用</p></li> <li><p>Gosched</p> <p>让出当前goroutine的执行权限，调度器安排其他等待的任务运行，并在下次某个时候从该位置恢复执行。</p></li> <li><p>NumCPU</p> <p>返回 CPU 核数量</p></li> <li><p>NumGoroutine</p> <p>返回正在执行和排队的任务总数</p></li> <li><p>GOMAXPROCS</p> <p>用来设置可以并行计算的CPU核数的最大值，并返回之前的值。</p></li></ul> <h2 id="links"><a href="#links" class="header-anchor">#</a> links</h2> <ul><li><a href="/编程语言/Go/preface.html">目录</a></li> <li>上一章: <a href="/编程语言/Go/02.6.html">interface</a></li> <li>下一节: <a href="/编程语言/Go/02.8.html">总结</a></li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/编程语言/Go/02.6.html" class="prev">
        2.6 interface
      </a></span> <span class="next"><a href="/编程语言/Go/02.8.html">
        2.8 总结
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.c08e831f.js" defer></script><script src="/assets/js/2.25a55803.js" defer></script><script src="/assets/js/256.dc16a169.js" defer></script>
  </body>
</html>
