(window.webpackJsonp=window.webpackJsonp||[]).push([[190],{567:function(e,t,n){"use strict";n.r(t);var s=n(13),r=Object(s.a)({},(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[n("h2",{attrs:{id:"ssl申请"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ssl申请"}},[e._v("#")]),e._v(" SSL申请")]),e._v(" "),n("p",[e._v("国内有很多的免费的SSL证书，比如腾讯云，比如阿里云，七牛云等等。申请下来之后会有不同几个版本，用与不同的环境")]),e._v(" "),n("p",[n("img",{attrs:{src:"http://oic1wftgk.bkt.clouddn.com/wp-content/uploads/ssl1.png",alt:""}})]),e._v(" "),n("p",[e._v("想我用的就是lnmp，自然使用Nginx的。")]),e._v(" "),n("h2",{attrs:{id:"证书配置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#证书配置"}},[e._v("#")]),e._v(" 证书配置")]),e._v(" "),n("h3",{attrs:{id:"监听端口443"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#监听端口443"}},[e._v("#")]),e._v(" 监听端口443")]),e._v(" "),n("p",[e._v("SSL默认监听的是443端口，所以得先开启443端口。")]),e._v(" "),n("p",[e._v("命令：")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",[n("code",[e._v("iptables -A INPUT -ptcp --dport 443 -j ACCEPT\n")])])]),n("h3",{attrs:{id:"修改配置文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#修改配置文件"}},[e._v("#")]),e._v(" 修改配置文件")]),e._v(" "),n("p",[e._v("先把发下来的证书文件"),n("code",[e._v("crt")]),e._v("和"),n("code",[e._v("key")]),e._v("上传到服务器，记住目录。接下来如果是"),n("code",[e._v("nginx")]),e._v(" ，需要在文件 "),n("code",[e._v("/nginx/conf/nginx.conf")]),e._v("文件中进行配置，修改以下内容：")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",[n("code",[e._v("server\n{\nlisten 80;\nlisten 443 ssl;\nserver_name www.codexz.cn;\nindex index.php index.html index.htm default.html;\nroot /www/web/www.codexz.cn;\n#error_page 404/404.html;\nssl_certificate key/www.codexz.cn/key.csr;\nssl_certificate_key key/www.codexz.cn/key.key;\nif ($server_port !~ 443){\nrewrite ^/.*$ https://$host$uri;\n}\nerror_page 497 https://$host$uri;\nerror_page 404 /404.html;\nerror_page 502 /502.html;\ninclude enable-php-70.conf;\ninclude rewrite/www.codexz.cn.conf;\nlocation ~ .*\\.(gif|jpg|jpeg|png|bmp|swf)$\n{\nexpires 30d;\naccess_log on;\n}\nlocation ~ .*\\.(js|css)?$\n{\nexpires 12h;\naccess_log on;\n}\naccess_log /www/wwwlogs/www.codexz.cn.log;\n}.\n#重启nginx服务\n")])])]),n("h2",{attrs:{id:"遇到的问题"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#遇到的问题"}},[e._v("#")]),e._v(" 遇到的问题")]),e._v(" "),n("p",[e._v("其实这个东西遇到的问题还是很多的。")]),e._v(" "),n("ol",[n("li",[n("p",[e._v('配置文件之后你的 nginx 会无法重启，提醒你 can"t find xxxx.so')])]),e._v(" "),n("li",[n("p",[e._v("打开网站 404 ，或者500，或者403.")])]),e._v(" "),n("li",[n("p",[e._v("访问的不是 https ,而是http。")])])]),e._v(" "),n("p",[e._v("出现以上所有的问题根据提示操作，一个个排错。")]),e._v(" "),n("h2",{attrs:{id:"_301重定向"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_301重定向"}},[e._v("#")]),e._v(" 301重定向")]),e._v(" "),n("p",[e._v("比如想让访问你的http://codexz.cn 自动跳转到https://www.codexz.cn,则需要将cl95.cc重定向：")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",[n("code",[e._v("if ($host ~ '^codexz.cn'){\n return 301 https://www.codexz.cn$uri;\n}\n")])])]),n("h2",{attrs:{id:"伪静态"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#伪静态"}},[e._v("#")]),e._v(" 伪静态")]),e._v(" "),n("p",[e._v("使用不同的建站程序需要不同的规则，比如"),n("code",[e._v("wordpress")]),e._v("则需要在"),n("code",[e._v("conf")]),e._v("文件中"),n("code",[e._v("include  wordpress.conf")]),e._v("文件，伪静态的文件一般安装的时候就会自动生成，保存在"),n("code",[e._v("rewrite")]),e._v("文件夹中。如果没有，百度，手动添加。")])])}),[],!1,null,null,null);t.default=r.exports}}]);