(window.webpackJsonp=window.webpackJsonp||[]).push([[217],{605:function(a,t,e){"use strict";e.r(t);var r=e(13),s=Object(r.a)({},(function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[e("h1",{attrs:{id:"基本集群搭建"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#基本集群搭建"}},[a._v("#")]),a._v(" 基本集群搭建")]),a._v(" "),e("h2",{attrs:{id:"安装准备"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#安装准备"}},[a._v("#")]),a._v(" 安装准备")]),a._v(" "),e("ol",[e("li",[a._v("JDK环境")]),a._v(" "),e("li",[e("a",{attrs:{href:"http://spark.apache.org/downloads.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("Spark官网"),e("OutboundLink")],1),a._v(" 下载相应的版本")]),a._v(" "),e("li",[a._v("SSh免密")])]),a._v(" "),e("h2",{attrs:{id:"开始搭建"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#开始搭建"}},[a._v("#")]),a._v(" 开始搭建")]),a._v(" "),e("ol",[e("li",[a._v("进入 "),e("code",[a._v("conf")]),a._v(" 文件夹，修改环境配置文件 "),e("code",[a._v("cp spark-env.sh.template spark-env.sh")]),a._v(" ,加入")])]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("#JDK环境\nexport JAVA_HOME=/usr/local/jdk-1.8\n#Master主机地址\nexport  SPARK_MASTER_IP=192.168.10.1\n#Master的RPC通信端口\nexport SPARK_MASTER_PORT=7077\n")])])]),e("ol",{attrs:{start:"2"}},[e("li",[e("code",[a._v("slaves")]),a._v(" 文件，写入从节点(Worker)主机地址")])]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("192.168.10.2\n192.168.10.3\n192.168.10.4\n")])])]),e("ol",{attrs:{start:"3"}},[e("li",[a._v("将配置好的 文件拷贝到其他节点")])]),a._v(" "),e("h2",{attrs:{id:"启动"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#启动"}},[a._v("#")]),a._v(" 启动")]),a._v(" "),e("p",[a._v("在 Master 机器上启动")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("start-all.sh\n")])])]),e("p",[a._v("jps查看进程，分别有 Master 、 Worker 进程，在 "),e("code",[a._v("8080")]),a._v(" 端口可以查看集群的基本信息")]),a._v(" "),e("h1",{attrs:{id:"spark-ha集群搭建"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#spark-ha集群搭建"}},[a._v("#")]),a._v(" Spark-HA集群搭建")]),a._v(" "),e("p",[a._v("基本集群搭建存在 "),e("code",[a._v("单点故障")]),a._v(" 问题，要解决此问题就要借助  "),e("code",[a._v("zookeeper")]),a._v(" ，启动最少 2 个Master")]),a._v(" "),e("h2",{attrs:{id:"规划"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#规划"}},[a._v("#")]),a._v(" 规划")]),a._v(" "),e("table",[e("thead",[e("tr",[e("th",[a._v("节点")]),a._v(" "),e("th",[a._v("安装软件")]),a._v(" "),e("th",[a._v("jps")])])]),a._v(" "),e("tbody",[e("tr",[e("td",[a._v("node-00")]),a._v(" "),e("td",[a._v("spark,scala")]),a._v(" "),e("td",[a._v("Master")])]),a._v(" "),e("tr",[e("td",[a._v("node-01")]),a._v(" "),e("td",[a._v("spark,scala")]),a._v(" "),e("td",[a._v("Master")])]),a._v(" "),e("tr",[e("td",[a._v("node-10")]),a._v(" "),e("td",[a._v("spark,scala,zookeeper")]),a._v(" "),e("td",[a._v("Worker,QuorumPeerMain")])]),a._v(" "),e("tr",[e("td",[a._v("node-11")]),a._v(" "),e("td",[a._v("spark,scala,zookeeper")]),a._v(" "),e("td",[a._v("Worker,QuorumPeerMain")])]),a._v(" "),e("tr",[e("td",[a._v("node-12")]),a._v(" "),e("td",[a._v("spark,scala,zookeeper")]),a._v(" "),e("td",[a._v("Worker,QuorumPeerMain")])])])]),a._v(" "),e("h2",{attrs:{id:"开始搭建-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#开始搭建-2"}},[a._v("#")]),a._v(" 开始搭建")]),a._v(" "),e("ol",[e("li",[e("code",[a._v("spark-env.sh")]),a._v(" ,删掉 "),e("code",[a._v("SPARK_MASTER_IP")]),a._v("，添加")])]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v('export JAVA_HOME=/usr/local/jdk-1.8\n#Master的RPC通信端口，如果是 7077可以省略\nexport SPARK_MASTER_PORT=7077\n#zk集群的主机地址，spark在zk中的文件存储路径\nexport SPARK_DAEMON_JAVA_OPTS="-Dspark.deploy.recoveryMode=ZOOKEEPER  -Dspark.deploy.zookeeper.url=node-10,node-11,node-12 -Dspark.deploy.zookeeper.dir=/spark"\n')])])]),e("ol",{attrs:{start:"2"}},[e("li",[a._v("node1 节点上 修改该 slaves 为 Worker 节点地址")])]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("node-10\nnode-11\nnode-12\n")])])]),e("ol",{attrs:{start:"3"}},[e("li",[a._v("拷贝 配置文件到所有节点")]),a._v(" "),e("li",[a._v("启动所有 zookeeper 节点")])]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("zkServer.sh start\n")])])]),e("ol",{attrs:{start:"5"}},[e("li",[a._v("node-00 上执行 "),e("code",[a._v("start-all.sh")]),a._v(", 会启动整个集群")]),a._v(" "),e("li",[a._v("node-01 上启动执行 "),e("code",[a._v("start-master.sh")])])]),a._v(" "),e("h1",{attrs:{id:"遇到的问题"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#遇到的问题"}},[a._v("#")]),a._v(" 遇到的问题")]),a._v(" "),e("ol",[e("li",[a._v("刚启动集群时，两个Master都是 standby")])]),a._v(" "),e("blockquote",[e("p",[a._v("解决： 没有启动zookeeper，启动zk集群就好了")])])])}),[],!1,null,null,null);t.default=s.exports}}]);