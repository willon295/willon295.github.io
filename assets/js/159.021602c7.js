(window.webpackJsonp=window.webpackJsonp||[]).push([[159],{521:function(t,s,a){"use strict";a.r(s);var e=a(13),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"正向代理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#正向代理"}},[t._v("#")]),t._v(" 正向代理")]),t._v(" "),a("p",[a("code",[t._v("正向代理")]),t._v(" 就是 用户通过 "),a("code",[t._v("代理服务器")]),t._v(" ，获取相应的 "),a("code",[t._v("目标服务器")]),t._v(" 内容。")]),t._v(" "),a("ol",[a("li",[t._v("大概流程\n"),a("code",[t._v("用户发送请求")]),t._v(" ==> "),a("code",[t._v("代理接受请求")]),t._v(" ==> "),a("code",[t._v("代理服务器获取并缓存目标服务器内容")]),t._v(" ==> "),a("code",[t._v("代理服务器返回内容给用户")]),t._v("。")]),t._v(" "),a("li",[t._v("举个实例： FQ(科学上网)")])]),t._v(" "),a("h2",{attrs:{id:"反向代理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#反向代理"}},[t._v("#")]),t._v(" 反向代理")]),t._v(" "),a("p",[t._v("听名字很高大上，简单概括就是： "),a("code",[t._v("请求分发")])]),t._v(" "),a("ol",[a("li",[t._v("大概流程\n"),a("code",[t._v("用户发送请求")]),t._v(" ==> "),a("code",[t._v("代理服务器")]),t._v("  ==> "),a("code",[t._v("转发给幕后N台服务器")]),t._v("  ==> "),a("code",[t._v("幕后服务器处理用户请求")])]),t._v(" "),a("li",[t._v("举个实例：百度搜索东西\n"),a("code",[t._v("发送请求")]),t._v(" ==> "),a("code",[t._v("代理服务器")]),t._v(" ==> "),a("code",[t._v("寻找与用户最近/同一网段的服务器")]),t._v(" ==> "),a("code",[t._v("最近/同一网段的服务器处理用户请求")])])]),t._v(" "),a("h3",{attrs:{id:"反向代理的好处"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#反向代理的好处"}},[t._v("#")]),t._v(" 反向代理的好处")]),t._v(" "),a("ol",[a("li",[t._v("负载均衡")]),t._v(" "),a("li",[t._v("访问加速")])]),t._v(" "),a("h2",{attrs:{id:"nginx反向代理配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nginx反向代理配置"}},[t._v("#")]),t._v(" Nginx反向代理配置")]),t._v(" "),a("h3",{attrs:{id:"demo01"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#demo01"}},[t._v("#")]),t._v(" Demo01")]),t._v(" "),a("p",[a("strong",[t._v("简单介绍")])]),t._v(" "),a("ol",[a("li",[t._v("两台 "),a("code",[t._v("tomcat")]),t._v(" 服务器, tomcat1监听 "),a("code",[t._v("8080")]),t._v(" ,tomcat2监听 "),a("code",[t._v("8081")])]),t._v(" "),a("li",[t._v("一台 "),a("code",[t._v("Nginx")]),t._v(" 代理服务器，监听 "),a("code",[t._v("80")])])]),t._v(" "),a("p",[a("strong",[t._v("hosts解析")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("127.0.0.1 tomcat1.com\n127.0.0.1 tomcat2.com\n")])])]),a("p",[a("strong",[t._v("配置")])]),t._v(" "),a("div",{staticClass:"language-nginx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-nginx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("upstream")]),t._v(" tomcat1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#真正处理tomcat1.com的服务器")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server")]),t._v(" 127.0.0.1:8080")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("upstream")]),t._v(" tomcat2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#真正处理tomcat2.com的服务器")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server")]),t._v(" 127.0.0.1:8081")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n\n\n"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("listen")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server_name")]),t._v(" tomcat1.com")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" /")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#将tomcat1.com请求转发给tomcat1")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_pass")]),t._v(" http://tomcat1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("index")]),t._v(" index.html index.php index.htm")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n\n\n"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("listen")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server_name")]),t._v(" tomcat2.com")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" /")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#将tomcat2.com请求转发给tomcat2")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_pass")]),t._v(" http://tomcat2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("index")]),t._v(" index.html index.php index.htm")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("h3",{attrs:{id:"demo02"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#demo02"}},[t._v("#")]),t._v(" Demo02")]),t._v(" "),a("ol",[a("li",[t._v("静态资源 , tomcat 服务器分离")]),t._v(" "),a("li",[t._v("反向代理, 带有权重")])]),t._v(" "),a("p",[t._v("样例")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("upstream  nginx_server{\n    server 10.0.0.101:80  weight=1;\n    server 10.0.0.102:80  weight=4;\n}\nupstream  tomcat_server{\n    server  10.0.2.101:8080 weight=1;\n    server  10.0.2.102:8080 weight=1;\n    server  10.0.2.103:8080 weight=1;\n}\n\nserver{\n    listen 80;\n    server_name demo.com;\n    \n    location ~* \\.[html|png|js|css|jpeg|gif]{\n        proxy_pass http://nginx_server;\n    }\n    \n    location / {\n        proxy_pass http://tomcat_server\n    }\n    \n}\n")])])])])}),[],!1,null,null,null);s.default=n.exports}}]);