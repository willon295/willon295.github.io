(window.webpackJsonp=window.webpackJsonp||[]).push([[195],{575:function(t,s,n){"use strict";n.r(s);var a=n(13),e=Object(a.a)({},(function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"简介"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#简介"}},[t._v("#")]),t._v(" 简介")]),t._v(" "),n("p",[t._v("小测试，一键给所有分布式服务器安装 "),n("code",[t._v("JAVA 环境")]),t._v(" 。")]),t._v(" "),n("ol",[n("li",[n("code",[t._v("hdp0")]),t._v(" 服务器负责 ：分发公钥，分发安装脚本，提供资源访问（JDK文件，这里使用httpd）")]),t._v(" "),n("li",[n("code",[t._v("hdp*")]),t._v(" 分布式服务器")])]),t._v(" "),n("h1",{attrs:{id:"实现"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#实现"}},[t._v("#")]),t._v(" 实现")]),t._v(" "),n("h2",{attrs:{id:"启动服务器配置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#启动服务器配置"}},[t._v("#")]),t._v(" 启动服务器配置")]),t._v(" "),n("ol",[n("li",[n("code",[t._v("hdp0")]),t._v(" ：安装并配置"),n("code",[t._v("httpd")]),t._v("，使得 "),n("code",[t._v("jdk-9.0.1_linux-x64_bin.tar.gz")]),t._v(" 可访问")]),t._v(" "),n("li",[n("code",[t._v("生成公钥")]),t._v("： 简单测试，使用 "),n("code",[t._v("ssh-keygen")]),t._v(" 即可生成，生成文件在 "),n("code",[t._v(".ssh/")]),t._v(" 目录")]),t._v(" "),n("li",[n("code",[t._v("boot.sh")]),t._v(": 启动脚本，用于分发公钥和执行脚本")]),t._v(" "),n("li",[n("code",[t._v("install.sh")]),t._v(": 各台服务器需要执行的脚本")])]),t._v(" "),n("h2",{attrs:{id:"代码"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#代码"}},[t._v("#")]),t._v(" 代码")]),t._v(" "),n("h3",{attrs:{id:"boot-sh"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#boot-sh"}},[t._v("#")]),t._v(" "),n("code",[t._v("boot.sh")])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('#! /usr/bin/bash\n\n#所有服务器的地址/域名\nSERVERS="hdp1 hdp2";\n\n#服务器的密码\nPASSWORD=hadoop\n\n#实现输入密码登录\nauto_ssh_copy_id(){\n\texpect -c "set timeout -1;\n\tspawn ssh-copy-id $1;\n\texpect {\n\t\t*yes/no* {send -- yes\\r;exp_continue;}\n\t\t*assword:* {send -- $2\\r;exp_continue;}\n\t\teof {exit 0;}\n\t}";\n}\n#分发公钥到所有服务器\nssh_copy_id_to_all(){\n\tfor SERVER in $SERVERS\n\tdo\n\t\tauto_ssh_copy_id $SERVER $PASSWORD\n\tdone\n}\n\n#分发公钥、执行脚本到所有服务器\nssh_copy_id_to_all\nfor SERVER in $SERVERS\ndo\n    scp install.sh root@$SERVER:/root\n    ssh root@$SERVER  "sh /root/install.sh"\ndone\n')])])]),n("h3",{attrs:{id:"install-sh"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#install-sh"}},[t._v("#")]),t._v(" "),n("code",[t._v("install.sh")])]),t._v(" "),n("p",[t._v("此处为安装JDK的执行代码")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("#! /usr/bin/bash\n\nyum install -y wget\nwget http://hdp0/software/jdk-9.0.1_linux-x64_bin.tar.gz\ntar -zxf jdk-9.0.1_linux-x64_bin.tar.gz -C /usr/local/\n#解压之后的文件夹名 jdk-9.0.1\ncat >> /etc/profile <<EOF\nexport JAVA_HOME=/usr/local/jdk-9.0.1\nexport  PATH=\\$JAVA_HOME/bin:\\$PATH\nEOF\n\n#注意美元符号要加 \\\nsource /etc/profile\nrm -f jdk-9.0.1_linux-x64_bin.tar.gz install.sh\n")])])])])}),[],!1,null,null,null);s.default=e.exports}}]);