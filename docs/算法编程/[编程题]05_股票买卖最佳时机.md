---
title: '[编程题]05_股票买卖最佳时机'
category: 编程题
tag: 编程题
date: 2018-03-20 00:05:00
---

# 题目

风口之下，猪都能飞。当今中国股市牛市，真可谓“错过等七年”。 给你一个回顾历史的机会，已知一支股票连续n天的价格走势，以长度为n的整数数组表示，数组中第i个元素（prices[i]）代表该股票第i天的股价。 假设你一开始没有股票，但有至多两次买入1股而后卖出1股的机会，并且买入前一定要先保证手上没有股票。若两次交易机会都放弃，收益为0。 设计算法，计算你能获得的最大收益。 输入数值范围：2<=n<=100,0<=prices[i]<=100

## 题目解释

1. 给定一个数组比如 [3,8,5,1,7,8]，表示每天的股票价格
2. 有且最多有两次买入售出的机会
3. 买入之前手上不可持有股票
4. 计算最大化收益

## Input


给定一个数组比如 [3,8,5,1,7,8]，表示每天的股票价格
```
3,8,5,1,7,8
```


## Output

计算最大化收益
```
12
```

# Coding



```

public class GuShi {

    /**
     * 计算你能获得的最大收益
     * @param prices Prices[i]即第i天的股价
     * @return 整型 第二次卖出后的最大化收益
     */
    public static int calculateMax(int[] prices) {

        //使用动态规划的思想，以收益为参考对象
        //1. 第一次买入收益为负数
        //2. 买入后收益 = 上次卖出收益 - 当前价格
        //3. 卖出后的收益 = 上次买入时 收益 + 当前价格
        int  firstBuy = Integer.MIN_VALUE;
        int  firstSell = 0;
        int  secondBuy= Integer.MIN_VALUE;
        int  secondSell = 0;

        for (int currentPrice : prices) {
            //第一次买入 ，收益是 负数
            firstBuy = Math.max(firstBuy,-currentPrice);
            //第一次 卖出， 收益最大化，当前价格  -  第一次买入价格
            firstSell = Math.max(firstSell,firstBuy+currentPrice);
            //第二次 买入的收益   第一次的收益- 当前价格
            secondBuy = Math.max(secondBuy,firstSell-currentPrice);
            secondSell = Math.max(secondSell,secondBuy+currentPrice);
        }
        return secondSell;

    }
    
}

```


# 利益最大化

1. 将买卖 `两次` 改成 `尽可能多` 的买卖

```
    public int maxProfit(int[] prices) {
        int sell = 0, prev_sell = 0, buy = Integer.MIN_VALUE, prev_buy;
        for (int price : prices) {
            
            prev_buy = buy;
            //当前买入的收益 = 上一次卖出收益 - 当前价格 ， 和 上一次买入收益 比较， 取最大值
            buy = Math.max(prev_sell - price, prev_buy);

            // 当前 卖出 收益 = 上一次买入收益+当前价格 ， 和  上一次卖出收益  比较，取最大值
            prev_sell = sell;
            sell = Math.max(prev_buy + price, prev_sell);
        }
        return sell;
    }


```
